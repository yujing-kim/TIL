# kubernetes

# 1ï¸âƒ£ ì´ˆê¸° ì„¤ì¹˜ ë° ì„¤ì •

## ê¸°ì¡´ì˜ ê°€ìƒ ë¨¸ì‹  ì „ë¶€ ì •ì§€

- /VirtualMV/Hashicorp/kubermetes/Vagrantfile

```docker
# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/bionic64"
  config.vm.hostname = "ubuntu"
  config.vm.network "private_network", ip: "192.168.111.110"
  config.vm.synced_folder ".", "/home/vagrant/sync", disabled: true
  config.vm.provider "virtualbox" do |vb|
    vb.cpus = 2
    vb.memory = 2048
  end
end
```

- `vagrant up` ì„ í†µí•´ ê°€ìƒë¨¸ì‹  ìƒì„±
- `vagrant ssh` ë¡œ ì ‘ì†

## íŒ¨í‚¤ì§€ ìµœì‹ í™”

```
vagrant@ubuntu:~$ sudo su
root@ubuntu:/home/vagrant# cd
root@ubuntu:~# apt update
root@ubuntu:~# apt upgrade
```

## ë„ì»¤ ì„¤ì¹˜ ë° ì„¤ì •

```
root@ubuntu:~# apt install docker.io -y

root@ubuntu:~# usermod -a -G docker vagrant
root@ubuntu:~# service docker restart
root@ubuntu:~# chmod 666 /var/run/docker.sock
```

- ë²„ì „ í™•ì¸

```
root@ubuntu:~# docker version
Client:
 Version:           19.03.6
 API version:       1.40
 Go version:        go1.12.17
 Git commit:        369ce74a3c
 Built:             Fri Feb 28 23:45:43 2020
 OS/Arch:           linux/amd64
 Experimental:      false

Server:
 Engine:
  Version:          19.03.6
  API version:      1.40 (minimum version 1.12)
  Go version:       go1.12.17
  Git commit:       369ce74a3c
  Built:            Wed Feb 19 01:06:16 2020
  OS/Arch:          linux/amd64
  Experimental:     false
 containerd:
  Version:          1.3.3-0ubuntu1~18.04.2
  GitCommit:        
 runc:
  Version:          spec: 1.0.1-dev
  GitCommit:        
 docker-init:
  Version:          0.18.0
  GitCommit:
```

## kubectl ì„¤ì¹˜

- ì¿ ë²„ë„¤í‹°ìŠ¤ ì»¤ë§¨ë“œ ë¼ì¸ ë„êµ¬ì¸ kubectlì„ ì‚¬ìš©
- [https://kubernetes.io/ko/docs/tasks/tools/install-kubectl/](https://kubernetes.io/ko/docs/tasks/tools/install-kubectl/)

- ì„¤ì¹˜

```
root@ubuntu:~# apt-get update && sudo apt-get install -y apt-transport-https gnupg2

root@ubuntu:~# curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -
OK

root@ubuntu:~# echo "deb https://apt.kubernetes.io/ kubernetes-xenial main" | sudo tee -a /etc/apt/sources.list.d/kubernetes.list

root@ubuntu:~# apt-get update

root@ubuntu:~# apt-get install -y kubectl
```

- ì„¤ì¹˜ í™•ì¸
    - ì•„ì§ í´ëŸ¬ìŠ¤í„°ê°€ ì—†ê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ê°€ ë‚  ìˆ˜ ìˆë‹¤.

```
root@ubuntu:~# kubectl version
Client Version: version.Info{Major:"1", Minor:"19", GitVersion:"v1.19.2", GitCommit:"f5743093fd1c663cb0cbc89748f730662345d44d", GitTreeState:"clean", BuildDate:"2020-09-16T13:41:02Z", GoVersion:"go1.15", Compiler:"gc", Platform:"linux/amd64"}
The connection to the server localhost:8080 was refused - did you specify the right host or port?
```

## Minikube ì„¤ì¹˜

- ë‹¨ì¼ ë…¸ë“œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ë…¸íŠ¸ë¶ì˜ ê°€ìƒ ë¨¸ì‹ ì—ì„œ êµ¬ë™í•˜ëŠ” ë„êµ¬ì¸ Minikubeì˜ ì„¤ì¹˜

```
root@ubuntu:~# curl -Lo minikube https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64 \
>   && chmod +x minikube
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 55.8M  100 55.8M    0     0  6761k      0  0:00:08  0:00:08 --:--:-- 7047k

root@ubuntu:~# mkdir -p /usr/local/bin/

root@ubuntu:~# install minikube /usr/local/bin/
```

- ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ì„œ ë¡œì»¬ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆë‹¤.

```
vagrant@ubuntu:~$ minikube start
ğŸ˜„  minikube v1.13.0 on Ubuntu 18.04 (vbox/amd64)
âœ¨  Automatically selected the docker driver

â›”  Requested memory allocation (1992MB) is less than the recommended minimum 2000MB. Deployments may fail.

ğŸ§¯  The requested memory allocation of 1992MiB does not leave room for system overhead (total system memory: 1992MiB). You may face stability issues.
ğŸ’¡  Suggestion: Start minikube with less memory allocated: 'minikube start --memory=1992mb'

ğŸ‘  Starting control plane node minikube in cluster minikube
ğŸšœ  Pulling base image ...
ğŸ’¾  Downloading Kubernetes v1.19.0 preload ...
    > preloaded-images-k8s-v6-v1.19.0-docker-overlay2-amd64.tar.lz4: 486.28 MiB^[

ğŸ”¥  Creating docker container (CPUs=2, Memory=1992MB) ...
ğŸ³  Preparing Kubernetes v1.19.0 on Docker 19.03.8 ...
ğŸ”  Verifying Kubernetes components...
ğŸŒŸ  Enabled addons: default-storageclass, storage-provisioner
ğŸ„  Done! kubectl is now configured to use "minikube" by default
```

- minikube ìƒíƒœ, kubectl ë²„ì „ í™•ì¸

```
vagrant@ubuntu:~$ minikube status
minikube
type: Control Plane
host: Running
kubelet: Running
apiserver: Running
kubeconfig: Configured

vagrant@ubuntu:~$ kubectl version
Client Version: version.Info{Major:"1", Minor:"19", GitVersion:"v1.19.2", GitCommit:"f5743093fd1c663cb0cbc89748f730662345d44d", GitTreeState:"clean", BuildDate:"2020-09-16T13:41:02Z", GoVersion:"go1.15", Compiler:"gc", Platform:"linux/amd64"}
Server Version: version.Info{Major:"1", Minor:"19", GitVersion:"v1.19.0", GitCommit:"e19964183377d0ec2052d1f1fa930c4d7575bd50", GitTreeState:"clean", BuildDate:"2020-08-26T14:23:04Z", GoVersion:"go1.15", Compiler:"gc", Platform:"linux/amd64"}

vagrant@ubuntu:~$ kubectl version --short
Client Version: v1.19.2
Server Version: v1.19.0
```

---

# 2ï¸âƒ£ Kubernetes

## 1. ì¿ ë²„ë„¤í‹°ìŠ¤

- ëŒ€ë¶€ë¶„ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ "ì˜¤ë¸Œì íŠ¸"ë¼ê³  ë¶ˆë¦¬ëŠ” í˜•íƒœë¡œ ê´€ë¦¬
- ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œëŠ” ì»¨í…Œì´ë„ˆì˜ ì§‘í•©(pods), ì»¨í…Œì´ë„ˆì˜ ì§‘í•©ì„ ê´€ë¦¬í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬(replica set), ì‚¬ìš©ì(service account), ë…¸ë“œ(node) ê¹Œì§€ë„ í•˜ë‚˜ì˜ ì˜¤ë¸Œì íŠ¸ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ
- kubectl ëª…ë ¹ì–´ ë˜ëŠ” YAML íŒŒì¼ì„ ì •ì˜í•´ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ë¥¼ ì‚¬ìš©

### ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì˜¤ë¸Œì íŠ¸ í™•ì¸

```docker
vagrant@ubuntu:~$ kubectl api-resources
NAME                              SHORTNAMES   APIGROUP                       NAMESPACED   KIND
bindings                                                                      true         Binding
componentstatuses                 cs                                          false        ComponentStatus
configmaps                        cm                                          true         ConfigMap
endpoints                         ep                                          true         Endpoints
events                            ev                                          true         Event
limitranges                       limits                                      true         LimitRange
namespaces                        ns                                          false        Namespace
nodes                             no                                          false        Node
...

```

### íŠ¹ì • ì˜¤ë¸Œì íŠ¸ì˜ ìƒì„¸ ì„¤ëª… í™•ì¸

- podì— ëŒ€í•œ ìƒì„¸ ì„¤ëª…

```docker
vagrant@ubuntu:~$ kubectl explain pod
```

## 2. ì¿ ë²„ë„¤í‹°ìŠ¤ êµ¬ì„±

![k7c/Untitled.png](15/Untitled.png)

### ë§ˆìŠ¤í„° ë…¸ë“œ

- ì „ì²´ ì¿ ë²„ë„¤í‹°ìŠ¤ ì‹œìŠ¤í…œì„ ì œì–´í•˜ê³  ê´€ë¦¬í•˜ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ì„ ì‹¤í–‰

### ì›Œì»¤ ë…¸ë“œ

- ì‹¤ì œ ë°°í¬ë˜ëŠ” ì»¨í…Œì´ë„ˆ appì„ ì‹¤í–‰

### ì»¨íŠ¸ë¡¤ í”Œë ˆì¸(Control Plane)

- í´ëŸ¬ìŠ¤í„°ë¥¼ ì œì–´í•˜ê³  ì‘ë™ì‹œí‚´
- ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ì§€ëŠ” ì•ŠìŒ â‡’ ë…¸ë“œì—ì„œ ì²˜ë¦¬
- êµ¬ì„±ìš”ì†Œ
    - ì¿ ë²„ë„¤í‹°ìŠ¤ API ì„œë²„ : ì‚¬ìš©ì ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ êµ¬ì„± ìš”ì†Œì™€ í†µì‹ 
    - ìŠ¤ì¼€ì¤„ëŸ¬ : ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ë¥¼ ë‹´ë‹¹
    - ì»¨íŠ¸ë¡¤ëŸ¬ ë§¤ë‹ˆì € : êµ¬ì„± ìš”ì†Œ ë³µì œë³¸, ì›Œì»¤ ë…¸ë“œ ì¶”ì , ë…¸ë“œ ì¥ì•  ì²˜ë¦¬ ë“±ê³¼ ê°™ì€ í´ëŸ¬ìŠ¤í„° ë‹¨ì˜ ê¸°ëŠ¥ì„ ìˆ˜í–‰
    - etcd : í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì„ ì§€ì†ì ìœ¼ë¡œ ì €ì¥í•˜ëŠ” ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë¶„ì‚° ë°ì´í„° ì €ì¥ì†Œ

### ì›Œì»¤ë…¸ë“œ(Worker Node)

- ì»¨í…Œì´ë„ˆí™” ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ëŠ” ì‹œìŠ¤í…œ
- ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ê³  ëª¨ë‹ˆí„°ë§í•˜ë©° ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì„œë¹„ìŠ¤ë¥¼ ì œê³µ
- êµ¬ì„±ìš”ì†Œ
    - ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ëŠ” ë„ì»¤, rkt ë˜ëŠ” ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„(container runtime)
    - API ì„œë²„ì™€ í†µì‹ í•˜ê³  ë…¸ë“œì˜ ì»¨í…Œì´ë„ˆë¥¼ ê´€ë¦¬í•˜ëŠ” Kubelet
    - ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì„± ìš”ì†Œ ê°„ì— ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì„ ë¡œë“œë°¸ëŸ°ì‹±í•˜ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ ì„œë¹„ìŠ¤ í”„ë¡ì‹œ

---

# 3ï¸âƒ£ nginx ì»¨í…Œì´ë„ˆë¡œ êµ¬ì„±ëœ í¬ë“œë¥¼ ìƒì„±

### pod

- **ì»¨í…Œì´ë„ˆ ì• í”Œë¦¬ì¼€ì´ì…˜**ì˜ ê¸°ë³¸ ë‹¨ìœ„
- 1ê°œ ì´ìƒì˜ ì»¨í…Œì´ë„ˆë¡œ êµ¬ì„±ëœ ì»¨í…Œì´ë„ˆì˜ ì§‘í•©
- ì—¬ëŸ¬ ê°œì˜ ì»¨í…Œì´ë„ˆë¥¼ ì¶”ìƒí™”í•´ì„œ í•˜ë‚˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ë™ì‘í•˜ë„ë¡ ë¬¶ì–´ ë†“ì€ ì»¨í…Œì´ë„ˆì˜ ë¬¶ìŒ

### í¬ë“œ ìƒì„±

- ë””ë ‰í„°ë¦¬ ìƒì„± ë° ymlíŒŒì¼ ì‘ì„±

```yaml
vagrant@ubuntu:~$ mkdir ~/kube && cd ~/kube

vagrant@ubuntu:~/kube$ vi nginx-pod.yml
vagrant@ubuntu:~/kube$ cat nginx-pod.yml 
apiVersion: v1                          
kind: Pod                               
metadata:                                
  name: my-nginx-pod
spec:
  containers:
  - name: my-nginx-container
    image: nginx:latest
    ports:
    - containerPort: 80
      protocol: TCP
```

### ìƒˆë¡œìš´ í¬ë“œ ìƒì„± ë° í™•ì¸

- pods â†’ poë¡œ ì¶•ì•½ì–´ ì‚¬ìš© ê°€ëŠ¥

```yaml
vagrant@ubuntu:~/kube$ kubectl apply -f nginx-pod.yml 
pod/my-nginx-pod created

vagrant@ubuntu:~/kube$ kubectl get pods
NAME           READY   STATUS              RESTARTS   AGE
my-nginx-pod   0/1     ContainerCreating   0          9s

vagrant@ubuntu:~/kube$ kubectl get po
NAME           READY   STATUS    RESTARTS   AGE
my-nginx-pod   1/1     Running   0          25s
```

### ìƒì„±ëœ ë¦¬ì†ŒìŠ¤ì˜ ìì„¸í•œ ì •ë³´ë¥¼ í™•ì¸

```yaml
vagrant@ubuntu:~/kube$ kubectl describe pods my-nginx-pod
Name:         my-nginx-pod
Namespace:    default
Priority:     0
Node:         minikube/172.17.0.3
Start Time:   Fri, 18 Sep 2020 06:36:24 +0000
Labels:       <none>
Annotations:  <none>
Status:       Running
IP:           172.18.0.3    -> ì»¨í…Œì´ë„ˆì˜ ip
IPs:
  IP:  172.18.0.3
....
```

- ì´ì œ ì´ podì— ì ‘ì† í•´ë³´ê³  ì‹¶ë‹¤.

### í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ì— í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì„ì‹œ í¬ë“œë¥¼ ìƒì„±í•´ì„œ nginx í¬ë“œì— ë™ì‘ì„ í™•ì¸

- alicek106/ubuntu:curl ì´ë¯¸ì§€ë¥¼ ì´ìš©í•´ì„œ `debug` ì´ë¦„ì˜ í¬ë“œë¥¼ ìƒì„±
    - ë°”ë¡œ bashë¡œ ë“¤ì–´ê°„ë‹¤
- `â€”rm` ì˜µì…˜ì€ ì‘ë™ì„ ì¤‘ì§€í•¨(exit)ì™€ ë™ì‹œì— í¬ë“œê°€ ì‚­ì œëœë‹¤

```yaml
vagrant@ubuntu:~/kube$ kubectl run -it --rm debug --image=alicek106/ubuntu:curl --restart=Never bash
If you don't see a command prompt, try pressing enter.
root@debug:/# 
root@debug:/#
```

- ë‹¤ë¥¸ terminalì—ì„œ ì‘ë™í•˜ê³  ìˆëŠ” podë¥¼ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤

```yaml
vagrant@ubuntu:~$ kubectl get pods
NAME           READY   STATUS    RESTARTS   AGE
debug          1/1     Running   0          87s
my-nginx-pod   1/1     Running   0          7m37s
```

### debug í¬ë“œì—ì„œ my-nginx-pod(172.18.0.3)ìœ¼ë¡œ ìš”ì²­ì„ ì „ë‹¬

```yaml
vagrant@ubuntu:~/kube$ kubectl run -it --rm debug --image=alicek106/ubuntu:curl --restart=Never bash
If you don't see a command prompt, try pressing enter.
root@debug:/# curl 172.18.0.3
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
```

### exit ë¡œ í¬ë“œì—ì„œ ë‚˜ê°„ í›„, í¬ë“œê°€ ì‚­ì œëœ ê²ƒì„ í™•ì¸ í•´ë³´ì

- í™•ì¸ í•´ë³´ì„¸ìš”!

### kubectl exec ëª…ë ¹ìœ¼ë¡œ í¬ë“œì˜ ì»¨í…Œì´ë„ˆì— ëª…ë ¹ì–´ë¥¼ ì „ë‹¬

```
vagrant@ubuntu:~$ kubectl  exec -it my-nginx-pod -- bash

root@my-nginx-pod:/# ls /etc/nginx/
conf.d	fastcgi_params	koi-utf  koi-win  mime.types  modules  nginx.conf  scgi_params	uwsgi_params  win-utf
root@my-nginx-pod:/# exit
exit
vagrant@ubuntu:~$
```

- ë¡œê·¸ë¥¼ í™•ì¸

```
vagrant@ubuntu:~/kube$ kubectl logs my-nginx-pod
/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
/docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
10-listen-on-ipv6-by-default.sh: Getting the checksum of /etc/nginx/conf.d/default.conf
10-listen-on-ipv6-by-default.sh: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf
/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
/docker-entrypoint.sh: Configuration complete; ready for start up
172.18.0.4 - - [18/Sep/2020:06:45:59 +0000] "GET / HTTP/1.1" 200 612 "-" "curl/7.35.0" "-"
```

### podë¥¼ ì‚­ì œ - ì¿ ë²„ë„¤í‹°ìŠ¤ ì˜¤ë¸Œì íŠ¸ë¥¼ ì‚­ì œ

```
vagrant@ubuntu:~/kube$ kubectl delete -f nginx-pod.yml 
pod "my-nginx-pod" deleted
  	
vagrant@ubuntu:~/kube$ kubectl get po
No resources found in default namespace.
```

## 4. 2ê°œì˜ ì»¨í…Œì´ë„ˆë¥¼ ê°€ì§„ pod ì •ì˜

```
vagrant@ubuntu:~/kube$ cat nginx-pod-with-ubuntu.yml 
apiVersion: v1
kind: Pod
metadata:
        name: my-nginx-pod
spec:
        containers:
        - name: my-nginx-container
          image: nginx:latest
          ports:
          - containerPort: 80
            protocol: TCP

        - name: ubuntu-sidecar-container
          image: alicek106/rr-test:curl
          command: [ "tail" ]
          args: [ "-f", "/dev/null" ]
```

- ìƒì„±
    - ì²˜ìŒì—ëŠ” ì¤€ë¹„ì¤‘ ì´ì—ˆë‹¤ê°€ ìƒì„±ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
    - my-nginx-podì—ëŠ” my-nginx-container ì»¨í…Œì´ë„ˆì™€ ubuntu-sidecar-container ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ ì¤‘

```
vagrant@ubuntu:~/kube$ kubectl apply -f nginx-pod-with-ubuntu.yml 
pod/my-nginx-pod created

vagrant@ubuntu:~/kube$ kubectl get po
NAME           READY   STATUS              RESTARTS   AGE
my-nginx-pod   0/2     ContainerCreating   0          13s

vagrant@ubuntu:~/kube$ kubectl get po
NAME           READY   STATUS    RESTARTS   AGE
my-nginx-pod   2/2     Running   0          28s
```

- ëª…ë ¹ì–´ë¥¼ ì „ë‹¬í•  ë•Œ, ì›í•˜ëŠ” ì»¨í…Œì´ë„ˆë¡œ ëª…ë ¹ì„ ì „ë‹¬í•˜ëŠ” ë°©ë²•
    - ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ë””í´íŠ¸ ì»¨í…Œì´ë„ˆë¡œ ì „ë‹¬ëœë‹¤.

```
vagrant@ubuntu:~/kube$ kubectl exec -it my-nginx-pod -c ubuntu-sidecar-container -- bash
root@my-nginx-pod:/# exit
exit

vagrant@ubuntu:~/kube$ kubectl exec -it my-nginx-pod -- bash
Defaulting container name to my-nginx-container.
Use 'kubectl describe pod/my-nginx-pod -n default' to see all of the containers in this pod.
root@my-nginx-pod:/#
```

### ubuntu-sidecar-container ì—ì„œ [localhost](http://localhost) í–ˆì„ ë•Œ , nginxê°€ ë‚˜ì˜¤ë©´ ì´ìƒí•˜ë‹¤ëŠ” ê²ƒì„ ì•Œì•„ì•¼í•œë‹¤?

```
vagrant@ubuntu:~/kube$ kubectl exec -it my-nginx-pod -c ubuntu-sidecar-container -- bash

root@my-nginx-pod:/# curl localhost
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
```

- ubunut-sidecar-container ì»¨í…Œì´ë„ˆë§Œìœ¼ë¡œ êµ¬ì„±ëœ podë¥¼ ìƒì„±í•œ í›„ í•´ë‹¹ podì—ì„œ curlì„ ë™ì‘
    - ì•„ë¬´ê²ƒë„ ë‚˜ì˜¤ì§€ ì•ŠìŒ

```
vagrant@ubuntu:~/kube$ cat nginx-pod-test.yml 
apiVersion: v1
kind: Pod
metadata:
        name: my-nginx-pod-test
spec:
        containers:
        - name: ubuntu-sidecar-container
          image: alicek106/rr-test:curl
          command: [ "tail" ]
          args: [ "-f", "/dev/null" ]

vagrant@ubuntu:~/kube$ kubectl apply -f nginx-pod-test.yml
pod/my-nginx-pod-test created

vagrant@ubuntu:~/kube$ kubectl exec -it my-nginx-pod-test -- bash
root@my-nginx-pod-test:/# curl localhost
curl: (7) Failed to connect to localhost port 80: Connection refused
```

---