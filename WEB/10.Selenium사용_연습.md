
## Selenium
* 홈페이지
    * https://selenium-python.readthedocs.io/


* 웹브라우저 자동화 tool
    * javascript/css 지원, 기존 GUI브라우저 자동화 라이브러리
* 웹앱을 테스트 하는데 이용
* webdriver API를 통해 운영체제에 설치된 Chrome등 브라우저를 제어
    * 브라우저 별로 드라이버가 존재한다
* 브라우저를 직접 동작 시키기 때문에 javascript등 비동기적으로 혹은 뒤늦게 로드되는 컨텐츠들을 가져올 수 있다

---
### Selenium 설치 확인 및 설치


```python
!pip list # 현재 설치되어있는 라이브러리 목록보기
```

    Package                            Version  
    ---------------------------------- ---------
    alabaster                          0.7.11   
    anaconda-client                    1.7.2    
    anaconda-navigator                 1.9.2    
    anaconda-project                   0.8.2    
    appdirs                            1.4.3    
    asn1crypto                         0.24.0   
    astroid                            2.0.4    
    astropy                            3.0.4    
    atomicwrites                       1.2.1    
    attrs                              18.2.0   
    Automat                            0.7.0    
    Babel                              2.6.0    
    backcall                           0.1.0    
    backports.shutil-get-terminal-size 1.0.0    
    beautifulsoup4                     4.6.3    
    bitarray                           0.8.3    
    bkcharts                           0.2      
    blaze                              0.11.3   
    bleach                             2.1.4    
    bokeh                              0.13.0   
    boto                               2.49.0   
    Bottleneck                         1.2.1    
    certifi                            2018.8.24
    cffi                               1.11.5   
    chardet                            3.0.4    
    click                              6.7      
    cloudpickle                        0.5.5    
    clyent                             1.2.2    
    colorama                           0.3.9    
    comtypes                           1.1.7    
    conda                              4.5.11   
    conda-build                        3.15.1   
    constantly                         15.1.0   
    contextlib2                        0.5.5    
    cryptography                       2.3.1    
    cycler                             0.10.0   
    Cython                             0.28.5   
    cytoolz                            0.9.0.1  
    dask                               0.19.1   
    datashape                          0.5.4    
    decorator                          4.3.0    
    defusedxml                         0.5.0    
    distributed                        1.23.1   
    docutils                           0.14     
    entrypoints                        0.2.3    
    et-xmlfile                         1.0.1    
    fastcache                          1.0.2    
    filelock                           3.0.8    
    Flask                              1.0.2    
    Flask-Cors                         3.0.6    
    gevent                             1.3.6    
    glob2                              0.6      
    greenlet                           0.4.15   
    h5py                               2.8.0    
    heapdict                           1.0.0    
    html5lib                           1.0.1    
    hyperlink                          18.0.0   
    idna                               2.7      
    imageio                            2.4.1    
    imagesize                          1.1.0    
    incremental                        17.5.0   
    ipykernel                          4.10.0   
    ipython                            6.5.0    
    ipython-genutils                   0.2.0    
    ipywidgets                         7.4.1    
    isort                              4.3.4    
    itsdangerous                       0.24     
    jdcal                              1.4      
    jedi                               0.12.1   
    Jinja2                             2.10     
    jsonschema                         2.6.0    
    jupyter                            1.0.0    
    jupyter-client                     5.2.3    
    jupyter-console                    5.2.0    
    jupyter-core                       4.4.0    
    jupyterlab                         0.34.9   
    jupyterlab-launcher                0.13.1   
    jupyterthemes                      0.20.0   
    keyring                            13.2.1   
    kiwisolver                         1.0.1    
    lazy-object-proxy                  1.3.1    
    lesscpy                            0.14.0   
    llvmlite                           0.24.0   
    locket                             0.2.0    
    lxml                               4.2.5    
    MarkupSafe                         1.0      
    matplotlib                         2.2.3    
    mccabe                             0.6.1    
    menuinst                           1.4.14   
    mistune                            0.8.3    
    mkl-fft                            1.0.4    
    mkl-random                         1.0.1    
    more-itertools                     4.3.0    
    mpmath                             1.0.0    
    msgpack                            0.5.6    
    multipledispatch                   0.6.0    
    navigator-updater                  0.2.1    
    nbconvert                          5.4.0    
    nbformat                           4.4.0    
    networkx                           2.1      
    nltk                               3.3      
    nose                               1.3.7    
    notebook                           5.6.0    
    numba                              0.39.0   
    numexpr                            2.6.8    
    numpy                              1.15.1   
    numpydoc                           0.8.0    
    odo                                0.5.1    
    olefile                            0.46     
    openpyxl                           2.5.6    
    packaging                          17.1     
    pandas                             1.0.5    
    pandocfilters                      1.4.2    
    parso                              0.3.1    
    partd                              0.3.8    
    path.py                            11.1.0   
    pathlib2                           2.3.2    
    patsy                              0.5.0    
    pep8                               1.7.1    
    pickleshare                        0.7.4    
    Pillow                             5.2.0    
    pip                                10.0.1   
    pkginfo                            1.4.2    
    pluggy                             0.7.1    
    ply                                3.11     
    prometheus-client                  0.3.1    
    prompt-toolkit                     1.0.15   
    psutil                             5.4.7    
    py                                 1.6.0    
    pyasn1                             0.4.4    
    pyasn1-modules                     0.2.2    
    pycodestyle                        2.4.0    
    pycosat                            0.6.3    
    pycparser                          2.18     
    pycrypto                           2.6.1    
    pycurl                             7.43.0.2 
    pyflakes                           2.0.0    
    Pygments                           2.2.0    
    pylint                             2.1.1    
    pymongo                            3.10.1   
    PyMySQL                            0.10.0   
    pyodbc                             4.0.24   
    pyOpenSSL                          18.0.0   
    pyparsing                          2.2.0    
    PySocks                            1.6.8    
    pytest                             3.8.0    
    pytest-arraydiff                   0.2      
    pytest-astropy                     0.4.0    
    pytest-doctestplus                 0.1.3    
    pytest-openfiles                   0.3.0    
    pytest-remotedata                  0.3.0    
    python-dateutil                    2.7.3    
    pytz                               2018.5   
    PyWavelets                         1.0.0    
    pywin32                            223      
    pywinpty                           0.5.4    
    PyYAML                             3.13     
    pyzmq                              17.1.2   
    QtAwesome                          0.4.4    
    qtconsole                          4.4.1    
    QtPy                               1.5.0    
    requests                           2.19.1   
    rope                               0.11.0   
    ruamel-yaml                        0.15.46  
    scikit-image                       0.14.0   
    scikit-learn                       0.19.2   
    scipy                              1.1.0    
    seaborn                            0.9.0    
    Send2Trash                         1.5.0    
    service-identity                   17.0.0   
    setuptools                         40.2.0   
    simplegeneric                      0.8.1    
    singledispatch                     3.4.0.3  
    six                                1.11.0   
    snowballstemmer                    1.2.1    
    sortedcollections                  1.0.1    
    sortedcontainers                   2.0.5    
    Sphinx                             1.7.9    
    sphinxcontrib-websupport           1.1.0    
    spyder                             3.3.1    
    spyder-kernels                     0.2.6    
    SQLAlchemy                         1.2.11   
    statsmodels                        0.9.0    
    sympy                              1.1.1    
    tables                             3.4.4    
    tblib                              1.3.2    
    terminado                          0.8.1    
    testpath                           0.3.1    
    toolz                              0.9.0    
    tornado                            5.1      
    tqdm                               4.26.0   
    traitlets                          4.3.2    
    Twisted                            18.7.0   
    unicodecsv                         0.14.1   
    urllib3                            1.23     
    wcwidth                            0.1.7    
    webencodings                       0.5.1    
    Werkzeug                           0.14.1   
    wheel                              0.31.1   
    widgetsnbextension                 3.4.1    
    win-inet-pton                      1.0.1    
    win-unicode-console                0.5      
    wincertstore                       0.2      
    wrapt                              1.10.11  
    xlrd                               1.1.0    
    XlsxWriter                         1.1.0    
    xlwings                            0.11.8   
    xlwt                               1.3.0    
    zict                               0.1.3    
    zope.interface                     4.5.0    
    

    You are using pip version 10.0.1, however version 20.2b1 is available.
    You should consider upgrading via the 'python -m pip install --upgrade pip' command.
    


```python
!pip install selenium
```

    Collecting selenium
      Downloading https://files.pythonhosted.org/packages/80/d6/4294f0b4bce4de0abf13e17190289f9d0613b0a44e5dd6a7f5ca98459853/selenium-3.141.0-py2.py3-none-any.whl (904kB)
    Requirement already satisfied: urllib3 in c:\anaconda3\lib\site-packages (from selenium) (1.23)
    Installing collected packages: selenium
    Successfully installed selenium-3.141.0
    

    twisted 18.7.0 requires PyHamcrest>=1.9.0, which is not installed.
    You are using pip version 10.0.1, however version 20.2b1 is available.
    You should consider upgrading via the 'python -m pip install --upgrade pip' command.
    


```python
!pip show selenium
```

    Name: selenium
    Version: 3.141.0
    Summary: Python bindings for Selenium
    Home-page: https://github.com/SeleniumHQ/selenium/
    Author: UNKNOWN
    Author-email: UNKNOWN
    License: Apache 2.0
    Location: c:\anaconda3\lib\site-packages
    Requires: urllib3
    Required-by: 
    

    You are using pip version 10.0.1, however version 20.2b1 is available.
    You should consider upgrading via the 'python -m pip install --upgrade pip' command.
    



---
### 크롬 드라이버 다운로드
* https://sites.google.com/a/chromium.org/chromedriver/downloads
* 각 브라우저별로 드라이버.exe 파일을 다운로드 받을 수 있다.
* selenium 객체를 생성할 때, 드라이브 파일의 위치가 필요하다.
---



## Webdriver 객체 생성


```python
from selenium import webdriver
import time

#Webdriver 객체생성 : chromedriver.exe 를 실행
browser = webdriver.Chrome('./chromedriver.exe')
#python.org 요청을 보내기
browser.get('https://www.python.org/')
#pypi 에 해당 element 를 찾기
menus = browser.find_elements_by_css_selector('#top ul.menu li')

pypi = None
for menu in menus:
    print(menu.text)
    if menu.text == 'PyPI':
        pypi = menu    
#click() 함수 실행
pypi.click()
#sleep
time.sleep(5)
#driver종료
browser.quit()
```

    Python
    PSF
    Docs
    PyPI
    Jobs
    Community
    


```python
from selenium import webdriver
import time

# Webdriver 객체 생성 : chromedriver.exe를 실행
driver = webdriver.Chrome('./chromedriver.exe')
print(driver)
# python.org 에 요청을 보내기 -> python.org 페이지가 생성
driver.get('https://www.naver.com/')
driver.save_screenshot("img/naver.png")

time.sleep(3)
driver.close()
```

    <selenium.webdriver.chrome.webdriver.WebDriver (session="5d229c37c81f3cd2f9057fba9c976159")>
    


```python

```
